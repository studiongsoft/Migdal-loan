import{j as e}from"./jsx-runtime-DMt_yit2.js";import{r as v}from"./iframe-Ci18ShzC.js";import{B as N}from"./Button-_FKim5JR.js";import{I as b}from"./InfoTooltip-C9zkFLtA.js";import{R as w}from"./Radio-CILNj6qV.js";function C(a,h,f,c){const l=[],i=h/100/12;let r=a;const s=f-c;if(s<=0)return l;const p=r*i*Math.pow(1+i,s)/(Math.pow(1+i,s)-1),n=new Date;n.setMonth(n.getMonth()+c);for(let d=0;d<s;d++){const u=r*i,x=p-u;r=Math.max(0,r-x);const t=new Date(n);t.setMonth(t.getMonth()+d),l.push({chargeDate:t.toLocaleDateString("he-IL",{day:"2-digit",month:"2-digit",year:"numeric"}),principalCharge:Math.round(x*100)/100,interestCharge:Math.round(u*100)/100,totalCharge:Math.round(p*100)/100,remainingTotal:Math.round(r*100)/100})}return l}function D({products:a,onDownload:h,primaryButtonLabel:f="אפשר להמשיך",onPrimaryButtonClick:c}){const[l,i]=v.useState(a[0]?.id??"");v.useEffect(()=>{const t=a[0]?.id??"";i(o=>a.some(g=>g.id===o)?o:t)},[a]);const r=a.find(t=>t.id===l)??a[0],s=v.useMemo(()=>r?C(r.loanAmount,r.annualRatePercent,r.months,r.graceMonths):[],[r]),p=s.reduce((t,o)=>t+o.totalCharge,0),n=t=>new Intl.NumberFormat("he-IL",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)+" ₪",d=t=>new Intl.NumberFormat("he-IL").format(t),u=()=>{if(!r)return;if(h){h(s,r);return}const o=["תאריך חיוב","חיוב קרן","חיוב ריביתי",'סה"כ חיוב','סה"כ נותר לתשלום'].join(",")+`
`+s.map(m=>[m.chargeDate,m.principalCharge,m.interestCharge,m.totalCharge,m.remainingTotal].join(",")).join(`
`),g=new Blob(["\uFEFF"+o],{type:"text/csv;charset=utf-8"}),y=URL.createObjectURL(g),j=document.createElement("a");j.href=y,j.download="loan-schedule.csv",j.click(),URL.revokeObjectURL(y)};if(a.length===0)return null;const x=a.length===1;return e.jsxs("div",{dir:"rtl",className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("h2",{className:"text-right text-[24px] font-bold text-[var(--color-primary)]",children:"לוח סילוקין"}),x&&r&&e.jsx("span",{className:"text-[16px] text-[#5E5D9A]",children:r.name})]}),!x&&e.jsx("div",{className:"flex flex-wrap gap-4",children:a.map(t=>e.jsx(w,{value:t.id,label:t.name,name:"amortization-product",checked:l===t.id,onChange:()=>i(t.id),variant:"card"},t.id))}),e.jsxs("div",{className:"rounded-[12px] p-6",children:[e.jsxs("div",{className:"relative mb-4 flex items-center justify-center",children:[e.jsxs("button",{type:"button",onClick:u,className:"absolute end-0 flex items-center gap-2 text-[16px] font-bold text-[#262565CC] hover:underline",children:["להורדה",e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M12 5v14M5 12l7 7 7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[16px] text-[#5E5D9A]",children:"סכום לתשלום"}),e.jsxs("p",{className:"text-[20px] font-bold text-[var(--color-primary)]",children:["₪",d(Math.round(p))]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-4 rounded-[12px] bg-[#F4F8FC] p-4 md:grid-cols-[minmax(180px,1.3fr)_1fr_1fr_1fr]",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"whitespace-nowrap text-[14px] text-[#5E5D9A]",children:"שיעור ריבית נומינלית שנתית"}),e.jsxs("div",{className:"flex flex-nowrap items-center gap-2",children:[e.jsxs("p",{className:"shrink-0 text-[18px] font-bold text-[var(--color-primary)]",children:[r?.annualRatePercent,"%"]}),e.jsx(b,{title:"שיעור ריבית נומינלית שנתית",body:"זהו שיעור הריבית השנתי שעל פיו מחושבים תשלומי ההחזר. הריבית מוצגת באחוזים ומהווה מדד להערכת עלות ההלוואה.",triggerVariant:"status"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[14px] text-[#5E5D9A]",children:"סוג הלוואה"}),e.jsx("p",{className:"text-[16px] font-bold text-[var(--color-primary)]",children:r?.loanType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[14px] text-[#5E5D9A]",children:"מספר חודשי החזר"}),e.jsx("p",{className:"text-[16px] font-bold text-[var(--color-primary)]",children:r?.months})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[14px] text-[#5E5D9A]",children:"מספר חודשי גרייס"}),e.jsx("p",{className:"text-[16px] font-bold text-[var(--color-primary)]",children:r?.graceMonths})]})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-[12px] border border-[#E1E9F3]",children:e.jsxs("table",{className:"w-full min-w-[500px] text-right",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-[#E1E9F3] bg-[#F4F8FC]",children:[e.jsx("th",{className:"p-3 text-[16px] font-bold text-[var(--color-primary)]",children:"תאריך חיוב"}),e.jsx("th",{className:"p-3 text-[16px] font-bold text-[var(--color-primary)]",children:"חיוב קרן"}),e.jsx("th",{className:"p-3 text-[16px] font-bold text-[var(--color-primary)]",children:"חיוב ריביתי"}),e.jsx("th",{className:"p-3 text-[16px] font-bold text-[var(--color-primary)]",children:'סה"כ חיוב'}),e.jsx("th",{className:"p-3 text-[16px] font-bold text-[var(--color-primary)]",children:'סה"כ נותר לתשלום'})]})}),e.jsx("tbody",{children:s.map((t,o)=>e.jsxs("tr",{className:"border-b border-[#E1E9F3] last:border-b-0",children:[e.jsx("td",{className:"p-3 text-[16px] text-[var(--color-primary)]",children:t.chargeDate}),e.jsx("td",{className:"p-3 text-[16px] text-[var(--color-primary)]",children:n(t.principalCharge)}),e.jsx("td",{className:"p-3 text-[16px] text-[var(--color-primary)]",children:n(t.interestCharge)}),e.jsx("td",{className:"p-3 text-[16px] text-[var(--color-primary)]",children:n(t.totalCharge)}),e.jsx("td",{className:"p-3 text-[16px] text-[var(--color-primary)]",children:n(t.remainingTotal)})]},o))})]})}),c&&e.jsx("div",{className:"flex justify-center",children:e.jsx(N,{variant:"primary",onClick:c,className:"w-full md:max-w-[400px]",children:f})})]})}D.__docgenInfo={description:"",methods:[],displayName:"AmortizationSchedule",props:{products:{required:!0,tsType:{name:"Array",elements:[{name:"ScheduleProduct"}],raw:"ScheduleProduct[]"},description:""},onDownload:{required:!1,tsType:{name:"signature",type:"function",raw:"(schedule: ScheduleRow[], product: ScheduleProduct) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"ScheduleRow"}],raw:"ScheduleRow[]"},name:"schedule"},{type:{name:"ScheduleProduct"},name:"product"}],return:{name:"void"}}},description:""},primaryButtonLabel:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"אפשר להמשיך"',computed:!1}},onPrimaryButtonClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{D as A};
